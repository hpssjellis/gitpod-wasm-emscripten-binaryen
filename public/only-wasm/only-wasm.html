
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hello World WebAssembly</title>
</head>
<body>
    <h1>WebAssembly Hello World Example</h1>
    <input type="button" value="Say Hello" onclick="sayHello()">
    <div id="message"></div> <!-- Container to display the message -->

    <script>
      async function loadWasm(filename) {
        const response = await fetch(filename);
        const buffer = await response.arrayBuffer();
        const module = await WebAssembly.compile(buffer);
        
        const imports = {
          env: {
            abort: console.log,
            emscripten_resize_heap: () => {}
            // If your WebAssembly uses other environment variables, define them here.
          }
        };

        const instance = await WebAssembly.instantiate(module, imports);
        return instance;
      }

      async function sayHello() {
        const instance = await loadWasm('hello_world.wasm');
        const ptr = instance.exports._hello();  // Pointer to the string in WebAssembly memory
        const message = readStringFromMemory(instance, ptr);
        document.getElementById('message').textContent = message;
      }

      function readStringFromMemory(instance, ptr) {
        const bytes = new Uint8Array(instance.exports.memory.buffer, ptr);
        let str = '';
        let i = 0;
        while (bytes[i] !== 0) {
          str += String.fromCharCode(bytes[i]);
          i++;
        }
        return str;
      }
    </script>
</body>
</html>


